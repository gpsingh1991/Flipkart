<!DOCTYPE html>
 <html lang="en" class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="UTF-8" />
        
        <title>Login and Registration Form with HTML5 and CSS3</title>
        
        <link rel="shortcut icon" href="../favicon.ico"> 
        <link rel="stylesheet" type="text/css" href="css/demo.css" />
        <link rel="stylesheet" type="text/css" href="css/style.css" />
		<link rel="stylesheet" type="text/css" href="css/animate-custom.css" />
        <script type="text/javascript">
        var db=null;
        window.onload=function(){
         db = window.openDatabase("flipkart", "1.0", "flipkart", 1000000);   
         //alert("done");
        }
        function $_(selector) {
    return document.querySelector(selector);
  }
//   $_("#Login").onclick=function() {
//     db.transaction(function(tx) {
//       console.log("running2");
//       tx.executeSql("select * from registration" ,[], function(tx, results) {
//         for (var i=0; i<results.rows.length; i++) {
//           var record = results.rows.item(i);
//           var name=record.username;
//           var password=record.password;
        
//         }
//       console.log("done");
//       // showRecords();
//       validate();
//     });
//   });
// };




       // var db = window.openDatabase("registration", "1.0", "city stats", 1000000);
//         var db = window.openDatabase("Login", "1.0", "Login", 1000000);
//         window.onload=function(){
//              if (!window.openDatabase) {
//     status("Database not supported");
//     return;

//         }
//         db.transaction(function(tx){
//             tx.executeSql("create table if not exists Login("+"customerid integer primary key,"
//                 +"username text,"
//                 + "password text"+")",null,null,logger);
//             showRecords();
//             console.log("entered into database");

//         });
//         function logger(tx,error){
//             console.log("Error",error.message);
//         }
//         function logArguments() {
//     console.log(arguments);
//   }
//   function $_(selector) {
//     return document.querySelector(selector);
//   }

//   $_("#Login").onclick = function() {
//     db.transaction(function(tx) {
//       console.log("running2");
//       tx.executeSql(
//           "insert into Login(username, password ) "
//         + "values (?,?)", [$_("#username").value, $_("#password").value],
//         null, logger
//       );
//       console.log("done");
//       showRecords();
//       validate();
//     });
//   };
//   function showRecords() {
//     console.log("db", db);
//     html = "";
//     db.transaction(function(tx) {
//       tx.executeSql("select * from Login", [], function(tx, results) {
//         for (var i=0; i<results.rows.length; i++) {
//           var record = results.rows.item(i);
//           html+="<button id='"+record.id+"' class='remove'>x</button> "
//             +record.name+" - "+record.population + "<br/>";
//         }
//         $_("#records").innerHTML = html;
//       });
//     });
//   }

// };

        
            function validate()
            {
                var usernameTextBox = document.getElementById("username");
                var passwordTextBox = document.getElementById("password");
                if(usernameTextBox.value=="" || usernameTextBox.value==null)
                {
                    alert("enter a valid name");
                }
                if(passwordTextBox.value=="" || passwordTextBox.value==null)
                {
                    alert("enter a valid password");
                }
                  db.transaction(function(tx) {
      console.log("running2");
      tx.executeSql("select * from registration where username=?" ,[usernameTextBox.value], function(tx, results) {
        if(results.rows.length===0)
        {
            alert("user doesn't exist please register first");
        }
        else
        {
            for (var i=0; i<results.rows.length; i++) {
                var record = results.rows.item(i);
                var name=record.username;
                var password=record.password;
                var id=record.userid;




                // if (window.localStorage.getItem(usernameTextBox.value)!==null) 
                // {
                //     if (window.localStorage.getItem(usernameTextBox.value)===passwordTextBox.value) 
                //     {
                //         window.sessionStorage.setItem("username",usernameTextBox.value);
                //         location.href="copy of design page.html";
                //     }
                //     else
                //     {
                //         alert("Incorrect password");
                //     }
                // }
          if(passwordTextBox.value==password && window.localStorage.getItem(usernameTextBox.value)!==null){
            if(window.localStorage.getItem(usernameTextBox.value)===passwordTextBox.value){
              window.sessionStorage.setItem("username",usernameTextBox.value);
              window.sessionStorage.setItem("cart",id);
               location.href="copy of design page.html";
            }
            
             }
        else
        {
            alert("wrong password");
        }
        }
        
}

        
    
        
      console.log("done");
      
      //validate();
    });
      // if(usernameTextBox.value==name &&passwordTextBox.value==password){
      //        location.href="copy of design page.html";
      //   }
      //   else
      //   {
      //       alert("user doesn't exist please register first");
      //   }
  });
            }
      //           db.transaction(function(tx){

      //               tx.executeSql("select * from registration" ,[], function(tx, results) {
      //   for (var i=0; i<results.rows.length; i++) {
      //     var record = results.rows.item(i);
      //     var name=record.username;
      //     var password=record.password;
        
      //   }
      //   alert(name);
    
      // });
      //           }



                //     if(name==usernameTextBox.value){
                //         alert("name exist");
                //     }
                // });
                // if (window.localStorage.getItem(usernameTextBox.value)!==null) 
                // {
                //     if (window.localStorage.getItem(usernameTextBox.value)===passwordTextBox.value) 
                //     {
                //         window.sessionStorage.setItem("username",usernameTextBox.value);
                //         location.href="copy of design page.html";
                //     }
                //     else
                //     {
                //         alert("Incorrect password");
                //     }
                // }
                // else
                // {
                //     alert("Please register first!");
                // }
            

            // function register()
            // {
            //     location.href="registrationpage.html";
            // }
         </script>
    </head>
    <body>
        <div class="container">
            <!-- Codrops top bar -->
            <div class="codrops-top">
               
                <div class="clr"></div>
            </div> 
            <section>				
                <div id="container_demo" >
                   <div id="wrapper">
                        <div id="login">
                            <form  autocomplete="on"> 
                                <h1>Log in</h1> 
                                <p> 
                                    <label for="username" class="uname" data-icon="u" > Your username </label>
                                    <input id="username" name="username" required="required" type="text" placeholder="myusername or mymail@mail.com"/>
                                </p>
                                <p> 
                                    <label for="password" class="youpasswd" data-icon="p"> Your password </label>
                                    <input id="password" name="password" required="required" type="password" placeholder="eg. X8df!90EO" /> 
                                </p>
                                <p class="keeplogin"> 
									<input type="checkbox" name="loginkeeping" id="loginkeeping" value="loginkeeping" /> 
									<label for="loginkeeping">Keep me logged in</label>
								</p>
                                <p class="login button"> 
                                    <input type="button" id="Login" value="Login" onclick="validate()" /> 
								</p>
                                <p class="change_link">
									Not a member yet ?
									<a href="registrationpage.html">Join us</a>
								</p>
                            </form>
                        </div>

                    </div>
                </div>  
            </section>
        </div>
    </body>
</html>